tf2autobot-upgrade: 1.53
tf2autobot-upgrade-demo: 1.10

Free version:

1.6:
Made it so only items with these skus get smelted:
    '1101;6',
    '133;6',
    '1099;6',
    '354;6',
    '129;6',
    '226;6',
    '442;6',
    '444;6',
    '131;6',
    '130;6',
    '406;6',
    '1150;6',
    '528;6',
    '140;6'
Not stuff like vaccinators because they're valuable or heavy weapons because they're good for tokens, just secondary items for soldier, demoman (except sticky jumper) and engineer.

Fixed a fallback bug that wasn't excluding fabricators/kits when applying the fallback price

1.7:

Fixed it so items that the bot can fetch using the autopricer if it's not in the pricelist can have fallbacks.

1.8:
I can't remember in detail but I made it so the code goes through the validator without any errors, it had a lot of bugs earlier and a user reported it not even launching.

1.9:

Fixed so if you !check a number the bot doesn't crash
Fixed some other bugs
Made it so !stop removes listings
Made it so if you use a custom pricer, pricesdb.io is used as a fallback if the price is missing in your local autopricer, example:
!check Strange Lurking Legionnaire
APP
 ‚Äî 6:40 PM
‚ö†Ô∏è Pricer failed, using PriceDB fallback
üîé Strange Lurking Legionnaire:
‚Ä¢ Buy  : 25.55 ref
‚Ä¢ Sell : 29.33 ref
https://pricedb.io/api/graph/30777;11

1.10:

Apparently I forgot to fill this in but I think it was a small update

1.11:
Added a autopricerMessages option, if disabled, the bot will never tell you about automatic price updates in the discord server.  
Added an systemMessages option, if disabled, the bot will never send system messages in the discord server.  
Added a readOnlyPricelist option, if enabled, the bot will never write to the pricelist file, it will only read it, load it into memory and make changes in there without writing them to the file, useful if multiple bots use one pricelist (one bot has the option disabled, all the other ones enable it)

Paid version:



Changes:
I don't really remember all the changes but I added more stuff to tokenGroups and I made it so for the premium version you can combine any tokens with &imsure.
I set "alwaysDeclineNonTF2Items" to false by default, it was true by default
Changes for 1.19:
Added !ctbulk and !ctkbulk, they perform the good token operations with one command.

Changes for 1.20:
Copy-pasted some stuff from bliss's fork of tf2autobot, I don't think I've completed it because the bot isn't making listings on pricedb.io

1.21:

Added 
                listings: priceListEntry.listings,
                priority: priceListEntry.priority,
to updateListings.ts

1.22: There's no update, please don't use tf2autobot-upgrade until 1.23, a critical value mismatching was discovered and you don't want to run your bots with that bug.
If you read this, change the version number from 1.21 to 1.22 in Bot.ts to stop getting notifications and turn off the buy or sell commands in options, then you can use this without the bug

1.23:
Fixed that critical value mismatch bug. I haven't tested it a lot yet but it should work now since I have tested it at least once and it worked, so you can turn on buy/sell commands again
If you're curious about what it was
Say you have no metal, the bot you're trading with does and you send a command to buy a quick-fix for 0.22 ref
This would happen:
‚åõ Please wait while I process your offer! You will be offered a Quick-Fix and 0.22 ref for 0 keys, 0 ref.

It happens the other way around too (it was discovered this way actually, a bot tried to take a quick-fix and 0.22 ref for nothing or something like that)
Bugs:
In PolishUserCart it said this:
        if (this.bot.inventoryManager.amountCanAfford(true, currencies, buyerInventory, []) < 1) {
I changed it to this:
        if (this.bot.inventoryManager.amountCanAfford(true, currencies, buyerInventory, [], isBuyer, sellKeyPrice.metal, buyKeyPrice.metal) < 1) {

In amountCanAfford itself it said const value = isBuyer ? buyKey : sellKey; which is a big mistake, it's supposed to be:
        const keyRate = isBuyer ? buyKey : sellKey;
        const value = price.toValue(keyRate);d


I think it works now, I've been working for many hours on this. Hopefully all catastrophic errors are gone.
This guy discovered the bug: https://steamcommunity.com/id/choubidou13
If you see him, let him know he can get a tour of duty ticket as a reward


1.24:

Added a function that automatically repairs pricelist.json on startup, slightly tested.


1.25 Improvements to bulk operation commands (like fixed abbreviations)

1.26:
Bug fixes

1.27: Fixed a crash

1.28: Improved command handling & bug fix

1.29: Made the price request command smarter

1.30:
Bug with extractItem ALWAYS adding item= to the message fixed

1.31:
Fixed incorrect value handling when the bot is selling tickets/expanders for 0.5 keys each


1.32:

Fixed a couple of rounding errors

1.33:

Fixed another rounding error

1.34:

Before, if you buy a file like tf2autobot-upgrade, it says "‚åõ Please wait while I process your offer! You will be offered a Normal Bat for 25 keys.", I fixed it so it now says "‚åõ Please wait while I process your offer! You will be offered a tf2autobot-upgrade for 25 keys."

1.35:

Basically same update as 1.34 but now with the !cart command.

1.36:

Made the !price command work better with files and also a few other bug fixes

1.37:

Fixed the !price command always resolving a file, also fixed "‚è≥ Crafting 0 Vaccinator(s)... üî®" bug
Also made it so crafting operations have to be for more than 0 operations.

1.38:

Clearer error messages

1.39:

Bug fix so if you type something like !w nc bp it properly becomes non-craftable backpack expander

1.40:

Added sniper and primary to bulk token crafting

1.41:

Added a !pricecheckbulk command

1.42:

"‚ùå I could not find any items in my pricelist that contain "strange part: tankillstreak destroyed"" bug fix

1.43:

Added a readOnlyPricelist option, if enabled, the bot will never write to the pricelist file, it will only read it, load it into memory and make changes in there without writing them to the file, useful if multiple bots use one pricelist (one bot has the option disabled, all the other ones enable it)

1.44:

Added a autopricerMessages option, if disabled, the bot will never tell you about automatic price updates in the discord server.  

1.45:

Bug fix

1.46:

A lot of bug fixes

1.47:

A lot of bug fixes

1.48:

Made it so if autopricerMessages is disabled, the bot also doesn't send tf2 messages like someone receiving a golden pan.


1.49:

Removed this:

        if (message.author === this.client.user) {
            return; // don't talk to myself
        }
So now you can chat to your bot on discord if it's linked to your discord account

Fixed "TypeError: Cannot read properties of undefined (reading 'includes')" fatal error

Added a invalidIntentItems options, made to mimic invalidItems (or INVALID_ITEMS) very closely, so if someone tries to take an item with intent buy for example you can get it sent for review

Huge bug fixes

1.50:

Fixed it so "Already attempting to log on, cannot log on again" doesn't make the bot crash
Updated the ctkbulk command so it crafts pda2, spy, scout, pyro, heavy, melee, sniper, medic, engineer and primary tokens
Added Sticky Jumper to the list of weapons that don't get smelted
Made it so only items with these skus get smelted:
    '1101;6',
    '133;6',
    '1099;6',
    '354;6',
    '129;6',
    '226;6',
    '442;6',
    '444;6',
    '131;6',
    '130;6',
    '406;6',
    '1150;6',
    '528;6',
    '140;6'
Not stuff like vaccinators because they're valuable or heavy weapons because they're good for tokens, just secondary items for soldier, demoman (except sticky jumper) and engineer.


1.51:

Fixed "Failed to update pricelist entry: "priority" must be greater than or equal to 0" bug
Made priority entries support numbers with decimals in them

1.52:

Cleaned file price messages a bit so when someone buys a file, it says for example "tf2autobot-upgrade - 0 keys, 0 ref / 40 keys (file)" it used to say "file:tf2autobot-upgrade - 0 keys, 0 ref / 40 keys (removed/not listed)"
About the whitelist of items that get smelted that was mentioned in 1.50, it didn't work, I had to also update craftDuplicateWeapons now.

1.53:

Made aussie autocorrect to australium in commands and fixed other autocorrect issues
Fixed a fallback bug that wasn't excluding fabricators/kits when applying the fallback price

1.54:

Fixed it so items that the bot can fetch using the autopricer if it's not in the pricelist can have fallbacks.
Made it so the !stop command removes the listings
Added priorityBuy to the pricelist so sell listings are sorted by priority and buy orders by priorityBuy
Made it so if you use a custom pricer, pricesdb.io is used as a fallback if the price is missing in your local autopricer, example:
!check Strange Lurking Legionnaire
APP
 ‚Äî 6:40 PM
‚ö†Ô∏è Pricer failed, using PriceDB fallback
üîé Strange Lurking Legionnaire:
‚Ä¢ Buy  : 25.55 ref
‚Ä¢ Sell : 29.33 ref
https://pricedb.io/api/graph/30777;11
NOTE: I recommend adding the item to your custom pricer because I don't think price changes get emitted from the fallback pricer.

Fixed so if you !check a number the bot doesn't crash
Fixed so if you !update a number the bot doesn't crash
Fixed so if you !add a number the bot doesn't crash
Fixed so if you !re a number the bot doesn't crash
Fixed so if you !addbulk numbers the bot doesn't crash
Fixed so if you !updatebulk numbers the bot doesn't crash
Fixed so if you !removebulk numbers the bot doesn't crash
And more

Added an systemMessages option, before, autopricerMessages also targetted system messages but now systemMessages does instead.
Fixed a couple of fatal bugs
Added a onlyHighValueListings option to options.json which if it is enabled, the bot only creates listings for items in the highValue group
Made it so on startup, missing options parameters get autoadded
Added !wnonhighvalue which withdraws all items that aren't in the highValue group, and !whighvalue which withdraws the opposite items
Removed spy + melee from bulk token combination since the ROI is low compared to spy + pda2 and other classes + melee

Fixed a key rate bug where if a user sends an offer with an item the bot is buying for a key and takes an item the bot sells for a key, the bot doesn't value them the same
Any time a key rate is involved I can miss bugs even if I try to test thoroughly

Fixed strange parts not being able to be updated

Improved donation commands handling

fixed "Crafting 0 vaccinators" bug
Fixed more commands handling

Added a new option: miscSettings.autoRefreshListingsInterval.seconds (default value: 1800, 30 minutes, before I added this option the program always refreshed the listings every 30 minutes)
